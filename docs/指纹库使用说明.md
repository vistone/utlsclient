# uTLS æŒ‡çº¹ä¸ User-Agent åŒ¹é…åº“ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
3. [API æ–‡æ¡£](#api-æ–‡æ¡£)
4. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
5. [å®æˆ˜åº”ç”¨](#å®æˆ˜åº”ç”¨)

---

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ uTLS æŒ‡çº¹ä¸ User-Agent åŒ¹é…åº“ï¼ŒåŒ…å«äº†æ‰€æœ‰æ”¯æŒçš„æµè§ˆå™¨æŒ‡çº¹é…ç½®ã€‚

### ç‰¹ç‚¹

- âœ… **36 ä¸ªé¢„é…ç½®æŒ‡çº¹**ï¼šæ¶µç›– Chromeã€Firefoxã€Edgeã€Safariã€iOS
- âœ… **User-Agent åŒ¹é…**ï¼šæ¯ä¸ªæŒ‡çº¹éƒ½æœ‰å¯¹åº”çš„ User-Agent
- âœ… **éšæœºé€‰æ‹©**ï¼šæ”¯æŒéšæœºè·å–æŒ‡çº¹
- âœ… **åˆ†ç±»æŸ¥è¯¢**ï¼šæŒ‰æµè§ˆå™¨ã€å¹³å°æŸ¥è¯¢
- âœ… **å®‰å…¨æ¨è**ï¼šæä¾›å®‰å…¨æŒ‡çº¹æ¨è
- âœ… **å®æ—¶è¿è¡Œ**ï¼šå·²æµ‹è¯•å¯ç”¨

### æ”¯æŒçš„æŒ‡çº¹ç±»å‹

| æµè§ˆå™¨ | æ•°é‡ | ç‰ˆæœ¬èŒƒå›´ |
|--------|------|----------|
| **Chrome** | 16 | 83 - 133 (åŒ…æ‹¬ç‰¹æ®Šç‰ˆæœ¬) |
| **Firefox** | 10 | 55 - 120 |
| **Edge** | 3 | 85 - 106 |
| **Safari (macOS)** | 1 | 17 |
| **iOS Safari** | 3 | 12 - 14 |
| **Random** | 3 | éšæœºæŒ‡çº¹ |
| **æ€»è®¡** | **36** | - |

---

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
go mod init your_project
go get github.com/refraction-networking/utls@v1.8.1
```

### 2. å¤åˆ¶æŒ‡çº¹åº“æ–‡ä»¶

å°† `fingerprint_ua_library.go` å¤åˆ¶åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚

### 3. å¯¼å…¥ä½¿ç”¨

```go
import (
    "fmt"
    utls "github.com/refraction-networking/utls"
)
```

---

## API æ–‡æ¡£

### åˆ›å»ºæŒ‡çº¹åº“

```go
// åˆ›å»ºæ–°çš„æŒ‡çº¹åº“å®ä¾‹
lib := NewFingerprintLibrary()
```

### è·å–æ‰€æœ‰æŒ‡çº¹

```go
// è·å–æ‰€æœ‰æŒ‡çº¹é…ç½®
profiles := lib.GetAllProfiles()
fmt.Printf("å…±æœ‰ %d ä¸ªæŒ‡çº¹é…ç½®\n", len(profiles))
```

### éšæœºé€‰æ‹©

```go
// éšæœºè·å–ä¸€ä¸ªæŒ‡çº¹
profile := lib.GetRandomProfile()
fmt.Printf("User-Agent: %s\n", profile.UserAgent)
```

### æŒ‰åç§°æŸ¥æ‰¾

```go
// æ ¹æ®åç§°è·å–æŒ‡çº¹
profile, err := lib.GetProfileByName("Chrome 133 - Windows")
if err != nil {
    log.Fatal(err)
}
```

### æŒ‰æµè§ˆå™¨æŸ¥è¯¢

```go
// è·å–ç‰¹å®šæµè§ˆå™¨çš„æ‰€æœ‰æŒ‡çº¹
firefoxProfiles := lib.GetProfilesByBrowser("Firefox")
chromeProfiles := lib.GetProfilesByBrowser("Chrome")

// éšæœºé€‰æ‹©ä¸€ä¸ªæµè§ˆå™¨çš„æŒ‡çº¹
profile, err := lib.GetRandomProfileByBrowser("Firefox")
if err != nil {
    log.Fatal(err)
}
```

### æŒ‰å¹³å°æŸ¥è¯¢

```go
// è·å–ç‰¹å®šå¹³å°çš„æ‰€æœ‰æŒ‡çº¹
windowsProfiles := lib.GetProfilesByPlatform("Windows")
macOSProfiles := lib.GetProfilesByPlatform("macOS")
iOSProfiles := lib.GetProfilesByPlatform("iOS")

// éšæœºé€‰æ‹©ä¸€ä¸ªå¹³å°çš„æŒ‡çº¹
profile, err := lib.GetRandomProfileByPlatform("Windows")
if err != nil {
    log.Fatal(err)
}
```

### æ¨èæŒ‡çº¹

```go
// è·å–æ¨èçš„æŒ‡çº¹ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰
recommended := lib.GetRecommendedProfiles()
for _, profile := range recommended {
    fmt.Printf("%s - %s\n", profile.Name, profile.Version)
}
```

### å®‰å…¨æŒ‡çº¹

```go
// è·å–å®‰å…¨æŒ‡çº¹ï¼ˆé¿å…æ£€æµ‹ï¼‰
safeProfiles := lib.GetSafeProfiles()
// è¿”å› Firefoxã€Random å’Œæœ€æ–° Chrome ç‰ˆæœ¬
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šéšæœºé€‰æ‹©æŒ‡çº¹

```go
package main

import (
    "fmt"
    "net"
    utls "github.com/refraction-networking/utls"
)

func main() {
    // åˆ›å»ºæŒ‡çº¹åº“
    lib := NewFingerprintLibrary()
    
    // éšæœºé€‰æ‹©ä¸€ä¸ªæŒ‡çº¹
    profile := lib.GetRandomProfile()
    
    fmt.Printf("ä½¿ç”¨æŒ‡çº¹: %s\n", profile.Name)
    fmt.Printf("User-Agent: %s\n", profile.UserAgent)
    
    // å»ºç«‹è¿æ¥
    conn, err := net.Dial("tcp", "example.com:443")
    if err != nil {
        panic(err)
    }
    defer conn.Close()
    
    // ä½¿ç”¨é€‰ä¸­çš„æŒ‡çº¹
    config := &utls.Config{
        ServerName: "example.com",
    }
    
    uconn := utls.UClient(conn, config, profile.HelloID)
    err = uconn.Handshake()
    if err != nil {
        panic(err)
    }
    
    fmt.Println("è¿æ¥æˆåŠŸï¼")
}
```

### ç¤ºä¾‹ 2ï¼šæŒ‰æµè§ˆå™¨é€‰æ‹©

```go
func createHTTPClient(browser string) (*http.Client, error) {
    lib := NewFingerprintLibrary()
    
    // éšæœºé€‰æ‹©æŒ‡å®šæµè§ˆå™¨çš„æŒ‡çº¹
    profile, err := lib.GetRandomProfileByBrowser(browser)
    if err != nil {
        return nil, err
    }
    
    // åˆ›å»º HTTP å®¢æˆ·ç«¯
    client := &http.Client{
        Transport: createUTLSTransport(profile.HelloID),
    }
    
    return client, nil
}

func createUTLSTransport(helloID utls.ClientHelloID) *http.Transport {
    return &http.Transport{
        DialTLS: func(network, addr string) (net.Conn, error) {
            conn, err := net.Dial(network, addr)
            if err != nil {
                return nil, err
            }
            
            host, _, _ := net.SplitHostPort(addr)
            config := &utls.Config{
                ServerName: host,
            }
            
            uconn := utls.UClient(conn, config, helloID)
            if err := uconn.Handshake(); err != nil {
                conn.Close()
                return nil, err
            }
            
            return uconn, nil
        },
    }
}

func main() {
    // ä½¿ç”¨ Firefox æŒ‡çº¹
    client, _ := createHTTPClient("Firefox")
    
    req, _ := http.NewRequest("GET", "https://example.com", nil)
    // è®¾ç½®åŒ¹é…çš„ User-Agent
    req.Header.Set("User-Agent", "...")
    
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}
```

### ç¤ºä¾‹ 3ï¼šæŒ‡çº¹è½®æ¢å™¨

```go
type FingerprintRotator struct {
    lib        *FingerprintLibrary
    current    int
    profiles   []FingerprintProfile
    interval   time.Duration
}

func NewFingerprintRotator(interval time.Duration) *FingerprintRotator {
    lib := NewFingerprintLibrary()
    safeProfiles := lib.GetSafeProfiles()
    
    return &FingerprintRotator{
        lib:      lib,
        profiles: safeProfiles,
        interval: interval,
    }
}

func (r *FingerprintRotator) GetNext() FingerprintProfile {
    profile := r.profiles[r.current]
    r.current = (r.current + 1) % len(r.profiles)
    return profile
}

func (r *FingerprintRotator) StartAutoRotate(callback func(FingerprintProfile)) {
    ticker := time.NewTicker(r.interval)
    go func() {
        for range ticker.C {
            profile := r.GetNext()
            callback(profile)
        }
    }()
}

func main() {
    rotator := NewFingerprintRotator(30 * time.Minute)
    
    rotator.StartAutoRotate(func(profile FingerprintProfile) {
        fmt.Printf("åˆ‡æ¢åˆ°æŒ‡çº¹: %s\n", profile.Name)
        // æ›´æ–°å®¢æˆ·ç«¯é…ç½®
    })
    
    // ä¿æŒè¿è¡Œ
    select {}
}
```

### ç¤ºä¾‹ 4ï¼šæ™ºèƒ½æŒ‡çº¹é€‰æ‹©å™¨

```go
type SmartFingerprintSelector struct {
    lib *FingerprintLibrary
}

func NewSmartSelector() *SmartFingerprintSelector {
    return &SmartFingerprintSelector{
        lib: NewFingerprintLibrary(),
    }
}

// æ ¹æ®ç›®æ ‡ç½‘ç«™é€‰æ‹©åˆé€‚çš„æŒ‡çº¹
func (s *SmartFingerprintSelector) SelectForTarget(target string) FingerprintProfile {
    // ç­–ç•¥1: é«˜ä»·å€¼ç›®æ ‡ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
    if s.isHighValueTarget(target) {
        profiles := s.lib.GetRecommendedProfiles()
        return profiles[rand.Intn(len(profiles))]
    }
    
    // ç­–ç•¥2: ä¸€èˆ¬ç›®æ ‡ä½¿ç”¨éšæœºæŒ‡çº¹æé«˜éšè”½æ€§
    if s.shouldUseRandom(target) {
        profiles := s.lib.GetProfilesByBrowser("Random")
        return profiles[rand.Intn(len(profiles))]
    }
    
    // ç­–ç•¥3: é»˜è®¤ä½¿ç”¨ Firefoxï¼ˆæœ€å®‰å…¨ï¼‰
    profiles := s.lib.GetProfilesByBrowser("Firefox")
    return profiles[rand.Intn(len(profiles))]
}

func (s *SmartFingerprintSelector) isHighValueTarget(target string) bool {
    highValue := []string{"google.com", "github.com", "cloudflare.com"}
    for _, domain := range highValue {
        if strings.Contains(target, domain) {
            return true
        }
    }
    return false
}

func (s *SmartFingerprintSelector) shouldUseRandom(target string) bool {
    return rand.Float64() < 0.3 // 30% æ¦‚ç‡ä½¿ç”¨éšæœº
}
```

---

## å®æˆ˜åº”ç”¨

### åº”ç”¨ 1ï¼šä»£ç†æœåŠ¡å™¨é›†æˆ

```go
package main

import (
    "fmt"
    "net/http"
    utls "github.com/refraction-networking/utls"
)

type ProxyServer struct {
    lib *FingerprintLibrary
}

func NewProxyServer() *ProxyServer {
    return &ProxyServer{
        lib: NewFingerprintLibrary(),
    }
}

func (p *ProxyServer) GetTransport() *http.Transport {
    // éšæœºé€‰æ‹©æŒ‡çº¹
    profile := p.lib.GetRandomProfile()
    
    fmt.Printf("ä½¿ç”¨æŒ‡çº¹: %s\n", profile.Name)
    
    return &http.Transport{
        DialTLS: func(network, addr string) (net.Conn, error) {
            return p.createUTLSConnection(addr, profile.HelloID)
        },
    }
}

func (p *ProxyServer) createUTLSConnection(addr string, helloID utls.ClientHelloID) (net.Conn, error) {
    conn, err := net.Dial("tcp", addr)
    if err != nil {
        return nil, err
    }
    
    config := &utls.Config{
        ServerName: addr,
    }
    
    uconn := utls.UClient(conn, config, helloID)
    if err := uconn.Handshake(); err != nil {
        conn.Close()
        return nil, err
    }
    
    return uconn, nil
}
```

### åº”ç”¨ 2ï¼šçˆ¬è™«æŒ‡çº¹ç®¡ç†

```go
type Scraper struct {
    lib           *FingerprintLibrary
    currentProfile FingerprintProfile
    client        *http.Client
}

func NewScraper() *Scraper {
    lib := NewFingerprintLibrary()
    profile := lib.GetRandomProfile()
    
    scraper := &Scraper{
        lib:            lib,
        currentProfile: profile,
    }
    
    // åˆ›å»º HTTP å®¢æˆ·ç«¯
    scraper.client = &http.Client{
        Transport: scraper.createTransport(),
        Timeout:   30 * time.Second,
    }
    
    return scraper
}

func (s *Scraper) createTransport() *http.Transport {
    return &http.Transport{
        DialTLS: func(network, addr string) (net.Conn, error) {
            conn, err := net.Dial(network, addr)
            if err != nil {
                return nil, err
            }
            
            config := &utls.Config{
                ServerName: addr,
            }
            
            uconn := utls.UClient(conn, config, s.currentProfile.HelloID)
            if err := uconn.Handshake(); err != nil {
                conn.Close()
                return nil, err
            }
            
            return uconn, nil
        },
    }
}

func (s *Scraper) Fetch(url string) (*http.Response, error) {
    req, err := http.NewRequest("GET", url, nil)
    if err != nil {
        return nil, err
    }
    
    // ä½¿ç”¨åŒ¹é…çš„ User-Agent
    req.Header.Set("User-Agent", s.currentProfile.UserAgent)
    req.Header.Set("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8")
    req.Header.Set("Accept-Language", "en-US,en;q=0.5")
    
    return s.client.Do(req)
}

func (s *Scraper) RotateFingerprint() {
    s.currentProfile = s.lib.GetRandomProfile()
    s.client.Transport = s.createTransport()
    fmt.Printf("åˆ‡æ¢æŒ‡çº¹: %s\n", s.currentProfile.Name)
}
```

### åº”ç”¨ 3ï¼šæ‰¹é‡è¯·æ±‚ç®¡ç†

```go
type BatchRequestManager struct {
    lib     *FingerprintLibrary
    workers []*Worker
}

type Worker struct {
    id      int
    profile FingerprintProfile
    client  *http.Client
}

func NewBatchRequestManager(workerCount int) *BatchRequestManager {
    lib := NewFingerprintLibrary()
    workers := make([]*Worker, workerCount)
    
    for i := 0; i < workerCount; i++ {
        profile := lib.GetRandomProfile()
        workers[i] = &Worker{
            id:      i,
            profile: profile,
            client:  createClientWithProfile(profile),
        }
    }
    
    return &BatchRequestManager{
        lib:     lib,
        workers: workers,
    }
}

func (m *BatchRequestManager) ExecuteRequests(urls []string) []*http.Response {
    results := make([]*http.Response, len(urls))
    
    for i, url := range urls {
        worker := m.workers[i%len(m.workers)]
        resp, _ := worker.Fetch(url)
        results[i] = resp
    }
    
    return results
}
```

---

## FingerprintProfile ç»“æ„

```go
type FingerprintProfile struct {
    Name         string              // æŒ‡çº¹åç§°
    HelloID      utls.ClientHelloID // uTLS æŒ‡çº¹ID
    UserAgent    string              // å¯¹åº”çš„ User-Agent
    Description  string              // æè¿°
    Platform     string              // å¹³å°ç±»å‹
    Browser      string              // æµè§ˆå™¨ç±»å‹
    Version      string              // ç‰ˆæœ¬å·
}
```

**å­—æ®µè¯´æ˜**ï¼š
- **Name**: å”¯ä¸€çš„æŒ‡çº¹åç§°æ ‡è¯†
- **HelloID**: uTLS çš„ ClientHelloID
- **UserAgent**: HTTP è¯·æ±‚åº”è¯¥ä½¿ç”¨çš„ User-Agent
- **Description**: äººç±»å¯è¯»çš„æè¿°
- **Platform**: æ“ä½œç³»ç»Ÿå¹³å°ï¼ˆWindows/macOS/iOS/Linuxï¼‰
- **Browser**: æµè§ˆå™¨ç±»å‹ï¼ˆChrome/Firefox/Edge/Safariï¼‰
- **Version**: æµè§ˆå™¨ç‰ˆæœ¬

---

## æœ€ä½³å®è·µ

### 1. æŒ‡çº¹ä¸€è‡´æ€§

**é‡è¦**ï¼šç¡®ä¿ TLS æŒ‡çº¹ä¸ HTTP å¤´éƒ¨ä¸€è‡´ï¼

```go
profile := lib.GetRandomProfile()

// âœ… æ­£ç¡®ï¼šä½¿ç”¨åŒ¹é…çš„ User-Agent
req.Header.Set("User-Agent", profile.UserAgent)

// âŒ é”™è¯¯ï¼šæ··ç”¨ä¸åŒçš„ User-Agent
req.Header.Set("User-Agent", "Chrome UA")  // ä¸ Firefox æŒ‡çº¹ä¸åŒ¹é…ï¼
```

### 2. æŒ‡çº¹è½®æ¢

```go
// æ¨èï¼šå®šæœŸè½®æ¢æŒ‡çº¹
ticker := time.NewTicker(30 * time.Minute)
for range ticker.C {
    profile := lib.GetRandomProfile()
    updateClient(profile)
}

// é¿å…ï¼šé¢‘ç¹åˆ‡æ¢
for i := 0; i < 100; i++ {
    profile := lib.GetRandomProfile()  // å¤ªå¿«äº†ï¼
}
```

### 3. å®‰å…¨ä¼˜å…ˆçº§

```go
// ä¼˜å…ˆä½¿ç”¨ Firefox å’ŒéšæœºæŒ‡çº¹
safeProfiles := lib.GetSafeProfiles()

// æœ€æ–°ç‰ˆæœ¬ä¹Ÿæ›´å®‰å…¨
recommended := lib.GetRecommendedProfiles()

// é¿å…æ—§ç‰ˆæœ¬
oldProfiles := lib.GetProfilesByBrowser("Chrome")  // å¯èƒ½åŒ…å«æ—§ç‰ˆæœ¬
```

### 4. åŒ¹é…çœŸå®çš„æµè§ˆå™¨è¡Œä¸º

```go
profile := lib.GetRandomProfile()

req, _ := http.NewRequest("GET", url, nil)
req.Header.Set("User-Agent", profile.UserAgent)

// æ·»åŠ å¹³å°ç›¸å…³çš„å¤´éƒ¨
if profile.Platform == "Windows" {
    req.Header.Set("Accept-Language", "en-US,en;q=0.9")
} else if profile.Platform == "macOS" {
    req.Header.Set("Accept-Language", "en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7")
}
```

---

## å®Œæ•´ç¤ºä¾‹

### è¿è¡ŒæŒ‡çº¹åº“ç¤ºä¾‹

```bash
cd fingerprint_library
go run fingerprint_ua_library.go
```

### è¾“å‡ºç¤ºä¾‹

```
========== æ‰€æœ‰æŒ‡çº¹é…ç½® ==========
=== æŒ‰æµè§ˆå™¨åˆ†ç±»çš„æŒ‡çº¹ ===

## Edge (3 ä¸ª)
  [1] Edge 106 - Windows - 106
  [2] Edge 85 - Windows - 85
  [3] Edge Auto - Windows - auto

## Chrome (16 ä¸ª)
  [1] Chrome 133 - Windows - 133
  [2] Chrome 133 - macOS - 133
  [3] Chrome 131 - Windows - 131
  ...

## Firefox (10 ä¸ª)
  [1] Firefox 120 - Windows - 120
  [2] Firefox 120 - macOS - 120
  ...

========== éšæœºæŒ‡çº¹ç¤ºä¾‹ ==========
éšæœºé€‰æ‹©: Firefox 55 - Windows
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0

========== æ¨èæŒ‡çº¹ ==========
Chrome 133 - Windows (å¹³å°: Windows, ç‰ˆæœ¬: 133)
Chrome 131 - Windows (å¹³å°: Windows, ç‰ˆæœ¬: 131)
Firefox 120 - Windows (å¹³å°: Windows, ç‰ˆæœ¬: 120)
...
```

---

**æœ€åæ›´æ–°**ï¼š2025-01-10  
**ç‰ˆæœ¬**ï¼š1.0.0  
**è¯´æ˜**ï¼šå®Œæ•´çš„ uTLS æŒ‡çº¹ä¸ User-Agent åŒ¹é…åº“
